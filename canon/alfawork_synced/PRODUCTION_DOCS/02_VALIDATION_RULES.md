# 02_VALIDATION_RULES.md — Правила валидации Canon Flat19

**Назначение:** Описывает технические требования к содержимому файлов в `CURRENT_SOT_FLAT19`. Эти правила должны проверяться автоматически скриптом `validate_canon.py`.

---

## 1. Структура файлов

Каждый файл в папке `CURRENT_SOT_FLAT19` обязан соответствовать шаблону:

### 1.1. Именование
*   Формат: `NN_NAME_OF_FILE.md`, где `NN` — число от 00 до 99.
*   Пример: `03_VOICES_PHASES_FORMATS.md`

### 1.2. Обязательные блоки заголовка
Сразу после заголовка H1 (`# Title`) должны следовать мета-блоки.

**Обязательный блок 1: P0 Keywords**
Должен начинаться с `## P0: Keywords` и содержать маркированный список.
```markdown
## P0: Keywords
- keyword1
- keyword2
```

**Обязательный блок 2: P0 Router**
Должен начинаться с `## P0: Router` и содержать инструкции маршрутизации.
```markdown
## P0: Router
- Если запрос про X → см. `YY_FILENAME.md`.
```

### 1.3. SOURCE Блок (для трассируемости)
Если файл является сборкой из legacy-источников, он должен содержать блок:
```markdown
## SOURCE: ...
- Evidence: {e:canon:NN}
- SHA256: ...
```
*Валидатор должен выдавать Warning, если блок отсутствует, но не Error (для новых файлов).*

## 2. Проверка целостности контента

### 2.1. Ссылки Evidence
Все ссылки вида `{e:canon:NN}` должны указывать на существующие ID в системе.
Формат: `{e:type:id}`.

### 2.2. Запрещенные паттерны
*   **PII:** В тексте не должно быть email-адресов, телефонов (кроме заглушек в примерах).
*   **Конфликт имен:** Не использовать устаревшее написание `HUYNDUN`. Разрешено только `HUNDUN`.
*   **Markdown:** Заголовки должны быть корректно отбиты пробелом (`# Header`, а не `#Header`).

## 3. Индексный файл (00)
Файл `00_INDEX_AND_ROUTING.md` является особым:
*   Он должен содержать список всех остальных файлов (01-18).
*   Если файл есть в папке, но нет в Индексе — **Error**.
*   Если файл есть в Индексе, но нет в папке — **Error**.

## 4. Чек-лист для разработчика (перед коммитом)
1.  Файл назван корректно?
2.  Есть `P0: Keywords`?
3.  Есть `P0: Router`?
4.  Файл добавлен в `00_INDEX_AND_ROUTING.md`?
5.  Скрипт `validate_canon.py` проходит без ошибок?
