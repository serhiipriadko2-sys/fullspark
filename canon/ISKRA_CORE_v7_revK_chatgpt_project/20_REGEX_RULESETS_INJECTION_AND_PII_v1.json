{
  "schema_version": "1.0",
  "updated_at": "2025-12-21",
  "notes": "SoT: regex rulesets used by security gates (PII/secrets/injection). This file is versioned and hashed in File 17. Patterns are intentionally conservative to reduce false positives.",
  "rulesets": {
    "pii": {
      "description": "Patterns for PII and secrets that must never appear in REDACTED/DERIVED/GOLD artifacts. Use allowlist_regex to avoid flagging obvious examples (example.com, 555 numbers).",
      "allowlist_regex": [
        "(?i)\\b[a-z0-9._%+-]+@example\\.com\\b",
        "\\b555[-\\s.]?01\\d{2}\\b",
        "\\b000-00-0000\\b"
      ],
      "patterns": [
        {
          "id": "PII_EMAIL",
          "regex": "(?i)\\b[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,}\\b",
          "flags": "i",
          "severity": "error",
          "scope": "any",
          "rationale": "Email addresses are PII in most org policies."
        },
        {
          "id": "PII_PHONE_LOOSE",
          "regex": "\\b(?:\\+?\\d{1,3}[-\\s.]?)?(?:\\(?\\d{2,4}\\)?[-\\s.]?)?\\d{3,4}[-\\s.]?\\d{4}\\b",
          "flags": "",
          "severity": "warn",
          "scope": "any",
          "rationale": "Phone numbers are PII; this is a conservative detector (warn) to reduce false positives."
        },
        {
          "id": "SECRET_OPENAI_KEY",
          "regex": "\\bsk-[A-Za-z0-9]{10,}\\b",
          "flags": "",
          "severity": "error",
          "scope": "any",
          "rationale": "API keys / secrets must never be stored in the pack."
        },
        {
          "id": "SECRET_PRIVATE_KEY_BLOCK",
          "regex": "BEGIN (?:RSA |EC |OPENSSH )?PRIVATE KEY",
          "flags": "",
          "severity": "error",
          "scope": "any",
          "rationale": "Private key material must never be committed."
        }
      ]
    },
    "injection": {
      "description": "Prompt-injection indicators. These patterns are primarily used on untrusted inputs/logs, not on SoT docs (SoT may discuss attacks).",
      "allowlist_regex": [],
      "patterns": [
        {
          "id": "INJ_IGNORE_PREVIOUS_INSTRUCTIONS",
          "regex": "(?i)\\bignore\\b.{0,40}\\b(previous|above)\\b.{0,40}\\b(instruction|message)s?\\b",
          "flags": "ims",
          "severity": "warn",
          "scope": "untrusted_only",
          "rationale": "Classic injection to override instructions."
        },
        {
          "id": "INJ_REVEAL_SYSTEM_PROMPT",
          "regex": "(?i)\\b(reveal|show|leak)\\b.{0,60}\\b(system prompt|developer message|hidden instruction)s?\\b",
          "flags": "ims",
          "severity": "warn",
          "scope": "untrusted_only",
          "rationale": "Requests to disclose hidden instructions."
        },
        {
          "id": "INJ_ACT_AS_JAILBREAK",
          "regex": "(?i)\\b(act as|pretend to be|roleplay as)\\b.{0,40}\\b(system|developer|root)\\b",
          "flags": "ims",
          "severity": "warn",
          "scope": "untrusted_only",
          "rationale": "Jailbreak framing that tries to elevate authority."
        },
        {
          "id": "INJ_DAN",
          "regex": "(?i)\\b(do anything now|DAN)\\b",
          "flags": "i",
          "severity": "warn",
          "scope": "untrusted_only",
          "rationale": "Common jailbreak token."
        }
      ]
    }
  }
}